function Event(a,b){return this.target=a,this.value=b,this}function Class(a){if(this._parents=[],this._props={},this._actions={},this._storage=[],a&&a.defaults)for(var b in a.defaults)this.create(b,a.defaults[b]);for(var c in a)this[c]=a[c];if(this.init){var d=Array.prototype.slice.call(arguments,1);this.init.apply(this,d)}return this}function Classp(a){return"object"==typeof a&&Array.isArray(a._parents)}function addParent(a,b,c){return Classp(a)?(a._parents.push(b),b.once("change:"+c,function(b){return a._parents.remove(b.target)})):void 0}function getset(a){return 1===arguments.length?this.get(a):this.set(a,arguments[1])}function View(a,b){if(this.model=b,this.$el=$("<div>"),a&&(a.tagName&&(this.$el=$("<"+a.tagName+">")),a.style&&this.$el.css(a.style),a.model&&(this.model=a.model,delete a.model),this.$el.attr("class",a.className||a.type),a.events))for(var c in a.events)this.$el.on(c,a.events[c].bind(this));return Class.apply(this,arguments),this}Array.prototype.remove=function(a){for(var b=0,c=null,d=0;d<this.length;d+=1){if(c=this[d],c===a)return this.splice(b,1),!0;++b}return null},Class.prototype.get=function(a){return this._props[a]},Class.prototype.create=function(a,b){if(this._props.hasOwnProperty(a))throw new Error("Attempt to create property "+a+" that already exists.");return this._props[a]=b,this[a]=getset.bind(this,a),addParent(b,this,a),this.trigger("create",b),this.trigger("create:"+a,b),b},Class.prototype.set=function(a,b){if(!this._props.hasOwnProperty(a))throw new Error("Attempt to set a property "+a+" that does not exist.");return this.trigger("change",b),this.trigger("change:"+a,b),addParent(b,this,a),this._props[a]=b},Class.prototype.destroy=function(a){return delete this._props[a],this.trigger("destroy",this._props[a])},Class.prototype.trigger=function(a,b,c){var d=this._actions[a];if(d)for(var e=new Event(c||this,b),f=[],g=null,h=0;h<d.length;h+=1){g=d[h],g.fun.call(g.self,e),g.once&&f.push(g);for(var g=null,i=0;i<f.length;i+=1)g=f[i],f.remove(g)}for(var j=null,k=this._parents,i=0;i<k.length;i+=1)j=k[i],j!==c&&this.trigger.call(j,a,b,c||this)},Class.prototype.on=function(a,b,c){var d={message:a,fun:b,self:c||this};return this._actions[a]?this._actions[a].push(d):this._actions[a]=[d],d},Class.prototype.once=function(a,b,c){var d={message:a,fun:b,self:c||this,once:!0};return this._actions[a]?this._actions[a].push(d):this._actions[a]=[d],d},Class.prototype.push=function(a){if(this.contains&&a.type!==this.contains)throw new Error("Attempt to push "+a.type+"into container for "+this.contains);return Classp(a)&&a._parents.push(this),this._storage.push(a),this.length=this._storage.length,this.trigger("add",a),this.trigger("change",a),a},Class.prototype.add=function(a){if(this.contains&&a.type!==this.contains)throw new Error("Attempt to push "+a.type+"into container for "+this.contains);return this.find(a)||this.push(a),a},Class.prototype.remove=function(a){var b=this._storage.remove(a);return b&&(this.trigger("remove",a),this.trigger("change",a),--this.length),b},Class.prototype.clear=function(){return this._storage=[],this.length=0,this.trigger("change",null)},Class.prototype.at=function(a){return this._storage[a]},Class.prototype.each=function(a,b){for(var c=b||this,d=null,e=this._storage,f=0;f<e.length;f+=1)d=e[f],a.call(c,d)},Class.prototype.map=function(a,b){for(var c=[],d=b||this,e=null,f=this._storage,g=0;g<f.length;g+=1)e=f[g],c.push(a.call(d,e));return c},Class.prototype.filter=function(a,b){for(var c=[],d=b||this,e=null,f=this._storage,g=0;g<f.length;g+=1)e=f[g],a.call(d,e)&&c.push(e);return c},Class.prototype.find=function(a){if("function"==typeof a){for(var b=null,c=this._storage,d=0;d<c.length;d+=1)if(b=c[d],a(b))return b}else for(var b=null,e=this._storage,f=0;f<e.length;f+=1)if(b=e[f],a===b)return b},View.prototype=Object.create(Class.prototype),View.prototype.constructor=View,module&&(module.exports.Class=Class),module&&(module.exports.View=View);